fix
479-A-bug-17995073-17995092
479-A-bug-18033506-18033525
479-A-bug-18240880-18240906
