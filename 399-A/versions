fix
399-A-bug-18007016-18007035
399-A-bug-6100324-6100345
399-A-bug-6301206-6301231
399-A-bug-6311202-6311263
399-A-bug-8015613-8015921
