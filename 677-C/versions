fix
677-C-bug-18192762-18193123
677-C-bug-18206311-18206325
677-C-bug-18262604-18262617
677-C-bug-18281182-18281188
