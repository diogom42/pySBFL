fix
339-C-bug-4534723-4534747
339-C-bug-7361204-7361256
339-C-bug-7361234-7361256
339-C-bug-7361248-7361256
