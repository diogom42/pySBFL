fix
676-A-bug-18172719-18182703
676-A-bug-18184926-18185014
676-A-bug-18211282-18211363
676-A-bug-18247191-18247237
