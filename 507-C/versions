fix
507-C-bug-10395815-10395870
507-C-bug-9529925-9529946
