fix
287-C-bug-3390031-3390437
287-C-bug-3391049-3391143
287-C-bug-3393834-3393848
287-C-bug-3393842-3393848
