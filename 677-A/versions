fix
677-A-bug-18241844-18241911
677-A-bug-18262663-18262671
677-A-bug-18331987-18332002
677-A-bug-18350045-18350054
