fix
584-A-bug-17598745-17598758
584-A-bug-17817097-17817103
584-A-bug-18044424-18044437
584-A-bug-18267139-18267163
584-A-bug-18355711-18355726
