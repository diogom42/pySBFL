fix
580-A-bug-17525135-17525166
580-A-bug-17995379-17995400
580-A-bug-18107163-18107188
580-A-bug-18257709-18257726
