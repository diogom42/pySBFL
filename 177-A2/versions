fix
177-A2-bug-1594730-1595168
177-A2-bug-1646901-1646904
177-A2-bug-3817845-3817851
